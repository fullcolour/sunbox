<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iTools | 太阳天气与汇率</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <style>
        :root {
            --apple-blue: #0071e3;
            --glass: rgba(255, 255, 255, 0.72);
        }

        body {
            background: #f5f5f7;
            background-image: radial-gradient(at 0% 0%, rgba(94, 234, 212, 0.15) 0px, transparent 50%),
                              radial-gradient(at 100% 100%, rgba(99, 102, 241, 0.15) 0px, transparent 50%);
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "PingFang SC", sans-serif;
            min-height: 100vh;
            color: #1d1d1f;
        }

        .apple-glass {
            background: var(--glass);
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.4);
            border-radius: 24px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.04);
        }

        .input-field {
            background: rgba(0, 0, 0, 0.04);
            border: 1px solid transparent;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .input-field:focus {
            background: white;
            border-color: var(--apple-blue);
            box-shadow: 0 0 0 4px rgba(0, 113, 227, 0.15);
            outline: none;
        }

        .btn-apple {
            background: var(--apple-blue);
            color: white;
            font-weight: 600;
            transition: all 0.2s;
        }

        .btn-apple:active {
            transform: scale(0.97);
            opacity: 0.9;
        }

        /* 隐藏 Chrome 自动填充背景 */
        input:-webkit-autofill {
            -webkit-box-shadow: 0 0 0px 1000px white inset;
        }
    </style>
</head>
<body class="flex items-center justify-center p-6">

    <div class="w-full max-w-4xl space-y-6">
        
        <header class="text-center mb-10 animate__animated animate__fadeIn">
            <h1 class="text-3xl font-semibold tracking-tight">太阳天气与汇率查询>
            <p class="text-gray-500 text-sm mt-1">实时数据 · 极简交互</p>
        </header>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            
            <section class="apple-glass p-8 animate__animated animate__fadeInLeft">
                <div class="flex items-center mb-6">
                    <div class="p-2 bg-green-100 rounded-lg mr-3">
                        <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    </div>
                    <h2 class="text-xl font-bold">汇率转换</h2>
                </div>

                <div class="space-y-4">
                    <div>
                        <span class="text-xs font-bold text-gray-400 ml-1">数值</span>
                        <input id="amount" type="number" value="100" class="input-field w-full p-4 rounded-xl text-lg font-medium">
                    </div>
                    <div class="flex items-center gap-3">
                        <div class="flex-1">
                            <span class="text-xs font-bold text-gray-400 ml-1">从</span>
                            <input id="fromCurrency" type="text" value="USD" class="input-field w-full p-4 rounded-xl text-center font-bold uppercase">
                        </div>
                        <div class="mt-4 text-gray-300">➜</div>
                        <div class="flex-1">
                            <span class="text-xs font-bold text-gray-400 ml-1">至</span>
                            <input id="toCurrency" type="text" value="CNY" class="input-field w-full p-4 rounded-xl text-center font-bold uppercase">
                        </div>
                    </div>
                    <button onclick="convertCurrency()" class="btn-apple w-full py-4 rounded-xl mt-2">计算</button>
                    
                    <div id="exchangeResult" class="mt-6 text-center py-4 bg-white/50 rounded-2xl hidden">
                        <p class="text-sm text-gray-400">换算结果</p>
                        <p id="exchangeValue" class="text-3xl font-bold text-blue-600 tracking-tighter">--</p>
                    </div>
                </div>
            </section>

            <section class="apple-glass p-8 animate__animated animate__fadeInRight">
                <div class="flex items-center mb-6">
                    <div class="p-2 bg-blue-100 rounded-lg mr-3">
                        <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"></path></svg>
                    </div>
                    <h2 class="text-xl font-bold">全球天气</h2>
                </div>

                <div class="space-y-4">
                    <div>
                        <span class="text-xs font-bold text-gray-400 ml-1">城市名称</span>
                        <input id="cityInput" type="text" placeholder="例如: Beijing" class="input-field w-full p-4 rounded-xl text-lg font-medium">
                    </div>
                    <button onclick="fetchWeather()" class="btn-apple w-full py-4 rounded-xl mt-2">获取报告</button>

                    <div id="weatherResult" class="mt-6 hidden animate__animated animate__fadeIn">
                        <div class="bg-gradient-to-br from-blue-500 to-indigo-600 p-6 rounded-2xl text-white text-center">
                            <p id="weatherCity" class="text-lg font-semibold opacity-80">--</p>
                            <p id="weatherTemp" class="text-5xl font-bold my-2 tracking-tighter">--°C</p>
                            <p id="weatherInfo" class="text-sm font-medium">实时数据更新</p>
                        </div>
                    </div>
                </div>
            </section>

        </div>

        <footer class="text-center pt-8">
            <p class="text-xs text-gray-400">数据源: Open-Meteo & ExchangeRate-API | 免登录免费服务</p>
        </footer>
    </div>

    <script>
        // 汇率换算逻辑
        async function convertCurrency() {
            const amount = document.getElementById('amount').value;
            const from = document.getElementById('fromCurrency').value.toUpperCase();
            const to = document.getElementById('toCurrency').value.toUpperCase();
            const resBox = document.getElementById('exchangeResult');
            const resVal = document.getElementById('exchangeValue');

            try {
                const response = await fetch(`https://api.exchangerate-api.com/v4/latest/${from}`);
                const data = await response.json();
                const rate = data.rates[to];
                const final = (amount * rate).toFixed(2);
                
                resVal.innerText = `${final} ${to}`;
                resBox.classList.remove('hidden');
                resBox.classList.add('animate__fadeInUp');
            } catch (error) {
                alert("汇率获取失败，请检查货币代码是否正确。");
            }
        }

        // 天气查询逻辑
        async function fetchWeather() {
            const city = document.getElementById('cityInput').value;
            const resBox = document.getElementById('weatherResult');
            const resCity = document.getElementById('weatherCity');
            const resTemp = document.getElementById('weatherTemp');

            if (!city) return alert("请输入城市名称");

            try {
                // 1. 地理编码转换（城市名转经纬度）
                const geoRes = await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${city}&count=1&language=zh`);
                const geoData = await geoRes.json();
                
                if (!geoData.results) throw new Error("未找到城市");
                
                const { latitude, longitude, name } = geoData.results[0];

                // 2. 获取天气数据
                const weatherRes = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current_weather=true`);
                const weatherData = await weatherRes.json();
                
                resCity.innerText = name;
                resTemp.innerText = `${weatherData.current_weather.temperature}°C`;
                
                resBox.classList.remove('hidden');
                resBox.classList.add('animate__fadeInUp');
            } catch (error) {
                alert("天气获取失败，请输入正确的城市名称。");
            }
        }
    </script>
</body>
</html>
